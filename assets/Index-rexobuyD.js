var B=Object.defineProperty;var N=(o,e,s)=>e in o?B(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var _=(o,e,s)=>(N(o,typeof e!="symbol"?e+"":e,s),s);import{d as v,i as T,r as y,o as C,w as I,a as u,c as f,b as i,e as U,v as D,f as R,g,h as E,n as M,u as S,t as O,j as q,k as P,l as k,m as $,p as L,F,q as j,_ as H}from"./index-0pPDYT0p.js";import{P as K,u as w,S as V,_ as A,a as z,L as W}from"./Loading-DZDpgGPh.js";class G{constructor(e){_(this,"pokemonDetails",[]);_(this,"pokemonResult");_(this,"pokemonsFormat",new K);_(this,"pokemonListStore",w());this.services=e}async execute(e){const s=await this.services.pokemons.searchByLimit(e);return this.pokemonListStore.setRowsNumber(s.count),this.getPokemonIdByUrl(s.results),await this.loopRequest(),this.pokemonsFormat.execute(this.pokemonDetails)}async loopRequest(){this.pokemonDetails=await Promise.all(this.pokemonResult.map(e=>this.searchPokemonTypes(e)))}searchPokemonTypes(e){return this.services.pokemons.searchByNameOrId(e.id)}getPokemonIdByUrl(e){this.pokemonResult=e.map(s=>{const[l,a]=s.url.match(/\/(\d+)\/$/)||[];return{name:s.name,id:a}})}}const J={class:"flex flex-col lg:flex-row"},Q={class:"w-full mb-12"},X={class:"flex flex-col items-center gap-2 mb-3"},Y=["onKeyup"],Z=v({__name:"PokemonSearch",props:{limit:{default:24},offset:{default:0}},emits:["isLoading"],setup(o,{emit:e}){const s=T("services"),l=e,a=o,d=y(""),r=w(),t=async c=>{try{l("isLoading",!0);const m=await new G(s).execute({limit:a.limit,offset:c??a.offset});if(a.offset===0||c===0)return r.setPokemon(m);r.addPokemons(m)}finally{l("isLoading",!1)}},n=async()=>{try{if(l("isLoading",!0),r.setPokemon([]),!d.value)return t(0);const p=await new V(s).execute(d.value);r.setPokemon([p])}catch{r.setPokemon([])}finally{l("isLoading",!1)}};return C(()=>t()),I(()=>a,()=>t(),{deep:!0}),(c,p)=>(u(),f("div",J,[i("div",Q,[i("div",X,[U(i("input",{"onUpdate:modelValue":p[0]||(p[0]=m=>d.value=m),onKeyup:R(g(n,["prevent"]),["enter"]),type:"search",class:"w-full lg:w-11/12 xl:w-11/12 form-input",placeholder:"Pesquise por nome ou id do pokemon"},null,40,Y),[[D,d.value]])])])]))}}),ee=i("span",{class:"font-bold text-white"},"â†‘",-1),se=[ee],te=v({__name:"InfinitScroll",props:{hasNextPage:{type:Boolean}},emits:["on-scroll-end"],setup(o,{emit:e}){const s=e,l=o,a=t=>{const n=t.scrollHeight-t.scrollTop===t.clientHeight;if(d(t),n&&l.hasNextPage)return s("on-scroll-end")},d=t=>{const n=t.querySelector(".to-top-button");if(t.scrollTop>50)return n.style.display="block";n.style.display="none"},r=t=>{t.scrollTop=0};return(t,n)=>(u(),f("div",{class:"infinit-scroll h-[75vh] lg:m-2 overflow-x-auto relative",onScroll:n[1]||(n[1]=c=>a(t.$el))},[E(t.$slots,"infinit-scroll-content"),i("button",{onClick:n[0]||(n[0]=g(c=>r(t.$el),["prevent"])),class:"to-top-button hidden bg-blue-500 hover:bg-blue-800 shadow-xl sticky bottom-0 float-end p-2 px-4 mx-4 rounded-full"},se)],32))}}),oe="/poke-front/assets/empty-DeyT-pWm.svg",ne={class:"flex flex-col items-center text-center"},ae=["width","src"],ie={id:"emptyMessage text-gray-400"},le=v({__name:"EmptyComponent",props:{emptyMessage:{default:"Nenhum registro encontrado"},width:{default:"150"},style:{}},setup(o){const e=o;return(s,l)=>(u(),f("div",ne,[i("img",{width:e.width,style:M(e.style),src:S(oe)},null,12,ae),i("span",ie,O(e.emptyMessage),1)]))}}),re={class:"flex w-full justify-center"},ce={class:"w-full lg:w-11/12 items-center rounded-sm relative"},me={key:1,class:"pokemon-list-grid gap-3"},ue=v({__name:"PokemonList",setup(o){const e=y({limit:24,offset:0}),s=y(!1),l=q(),a=w(),d=()=>{if(r.value)return e.value.offset=0;e.value.offset+=e.value.limit},r=P(()=>!a.getPokemonList.length),t=(m=!0)=>{s.value=m},n=m=>{l.push({name:"Details",params:{idOrName:m}})},c=()=>e.value.limit+e.value.offset,p=P(()=>c()<a.getRowsNumber);return(m,x)=>(u(),f("div",null,[k(Z,{limit:e.value.limit,offset:e.value.offset,onIsLoading:x[0]||(x[0]=h=>t(h))},null,8,["limit","offset"]),i("div",re,[i("div",ce,[k(te,{"has-next-page":p.value,onOnScrollEnd:d},{"infinit-scroll-content":$(()=>[r.value&&!s.value?(u(),L(le,{key:0})):(u(),f("div",me,[(u(!0),f(F,null,j(S(a).getPokemonList,(h,b)=>(u(),L(z,{key:b,name:h.name,id:h.id,onClick:g(fe=>n(h.id),["prevent"]),class:"w-52 h-72"},{"card-footer-content":$(()=>[k(A,{types:h.types},null,8,["types"])]),_:2},1032,["name","id","onClick"]))),128))]))]),_:1},8,["has-next-page"]),k(W,{"is-loading":s.value},null,8,["is-loading"])])])]))}}),de=H(ue,[["__scopeId","data-v-d0c68769"]]),pe=i("div",{class:"w-full flex"},[i("div",{class:"w-full mb-6 lg:mb-0"})],-1),ve=v({__name:"Index",setup(o){return(e,s)=>(u(),f("div",null,[pe,k(de)]))}});export{ve as default};
